import fs from 'fs';
import tail from 'tail';

export default class TailStrategy {

  constructor({file, line}){
    this.file = file;
    this.line = line;
  }

  async initialize(){
    this.system = new tail.Tail(this.file,{fromBeginning:true});
    this.system.on('line', this.line);
  }

  async dispatch(action){
    if(!action) return;

    // this will trigger tail on line...
    fs.appendFile(this.file, JSON.stringify(action)+'\n', (error) => {
      if (error) console.error(error);
    });

    // what to return to server?
  }

}
